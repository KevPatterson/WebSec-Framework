"""
Recursos de explotación: POCs en GitHub, herramientas y referencias.
"""

def get_xss_resources():
    """Recursos para XSS."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - XSS',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection',
                'description': 'Colección completa de payloads XSS, bypass de filtros y técnicas avanzadas'
            },
            {
                'name': 'XSS Payloads List',
                'url': 'https://github.com/payloadbox/xss-payload-list',
                'description': 'Lista extensa de payloads XSS para diferentes contextos'
            },
            {
                'name': 'Awesome XSS',
                'url': 'https://github.com/s0md3v/AwesomeXSS',
                'description': 'Recursos, herramientas y payloads para XSS'
            }
        ],
        'tools': [
            {'name': 'XSStrike', 'url': 'https://github.com/s0md3v/XSStrike', 'description': 'Herramienta automatizada de detección y explotación XSS'},
            {'name': 'BeEF', 'url': 'https://github.com/beefproject/beef', 'description': 'Browser Exploitation Framework'},
            {'name': 'dalfox', 'url': 'https://github.com/hahwul/dalfox', 'description': 'Scanner XSS rápido y potente'}
        ]
    }

def get_sqli_resources():
    """Recursos para SQL Injection."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - SQL Injection',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection',
                'description': 'Payloads SQLi para MySQL, PostgreSQL, MSSQL, Oracle, etc.'
            },
            {
                'name': 'SQL Injection Payload List',
                'url': 'https://github.com/payloadbox/sql-injection-payload-list',
                'description': 'Lista completa de payloads SQL injection'
            },
            {
                'name': 'SQLMap Tamper Scripts',
                'url': 'https://github.com/sqlmapproject/sqlmap/tree/master/tamper',
                'description': 'Scripts para bypassear WAFs y filtros'
            }
        ],
        'tools': [
            {'name': 'SQLMap', 'url': 'https://github.com/sqlmapproject/sqlmap', 'description': 'Herramienta automática de detección y explotación de SQLi'},
            {'name': 'jSQL Injection', 'url': 'https://github.com/ron190/jsql-injection', 'description': 'Cliente GUI para explotación SQLi'},
            {'name': 'Ghauri', 'url': 'https://github.com/r0oth3x49/ghauri', 'description': 'Herramienta SQLi avanzada'}
        ]
    }

def get_csrf_resources():
    """Recursos para CSRF."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - CSRF',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSRF%20Injection',
                'description': 'Técnicas y payloads para explotar CSRF'
            },
            {
                'name': 'CSRF PoC Generator',
                'url': 'https://github.com/merttasci/csrf-poc-generator',
                'description': 'Generador automático de POCs CSRF'
            }
        ],
        'tools': [
            {'name': 'Burp Suite', 'url': 'https://portswigger.net/burp', 'description': 'Para capturar y analizar requests'},
            {'name': 'CSRFTester', 'url': 'https://github.com/PaulSec/CSRF-Tester', 'description': 'Herramienta para testing de CSRF'}
        ]
    }

def get_lfi_resources():
    """Recursos para LFI."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - LFI',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion',
                'description': 'Payloads LFI/RFI, wrappers PHP y técnicas de bypass'
            },
            {
                'name': 'LFI Cheat Sheet',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md',
                'description': 'Guía completa de explotación LFI'
            }
        ],
        'tools': [
            {'name': 'LFISuite', 'url': 'https://github.com/D35m0nd142/LFISuite', 'description': 'Framework automatizado para explotación LFI'},
            {'name': 'Kadimus', 'url': 'https://github.com/P0cL4bs/Kadimus', 'description': 'Herramienta de detección y explotación LFI/RFI'}
        ]
    }

def get_ssrf_resources():
    """Recursos para SSRF."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - SSRF',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery',
                'description': 'Payloads SSRF, bypass de filtros y explotación de cloud metadata'
            },
            {
                'name': 'Awesome SSRF',
                'url': 'https://github.com/jdonsec/AllThingsSSRF',
                'description': 'Recursos y técnicas de SSRF'
            }
        ],
        'tools': [
            {'name': 'SSRFmap', 'url': 'https://github.com/swisskyrepo/SSRFmap', 'description': 'Herramienta automática de explotación SSRF'},
            {'name': 'Gopherus', 'url': 'https://github.com/tarunkant/Gopherus', 'description': 'Genera payloads gopher para explotar servicios internos'}
        ]
    }

def get_xxe_resources():
    """Recursos para XXE."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - XXE',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection',
                'description': 'Payloads XXE, blind XXE y técnicas de exfiltración'
            },
            {
                'name': 'XXE Lab',
                'url': 'https://github.com/jbarone/xxelab',
                'description': 'Laboratorio para practicar XXE'
            }
        ],
        'tools': [
            {'name': 'XXEinjector', 'url': 'https://github.com/enjoiz/XXEinjector', 'description': 'Herramienta automática de explotación XXE'},
            {'name': 'Burp Suite', 'url': 'https://portswigger.net/burp', 'description': 'Para detección y explotación manual'}
        ]
    }

def get_command_injection_resources():
    """Recursos para Command Injection."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - Command Injection',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection',
                'description': 'Payloads de command injection y bypass de filtros'
            },
            {
                'name': 'Reverse Shell Cheat Sheet',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md',
                'description': 'Colección de reverse shells para diferentes lenguajes'
            }
        ],
        'tools': [
            {'name': 'Commix', 'url': 'https://github.com/commixproject/commix', 'description': 'Herramienta automática de detección y explotación de command injection'},
            {'name': 'Netcat', 'url': 'https://nmap.org/ncat/', 'description': 'Para establecer reverse shells'}
        ]
    }

def get_cors_resources():
    """Recursos para CORS."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - CORS',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration',
                'description': 'Técnicas de explotación de CORS misconfiguration'
            },
            {
                'name': 'CORS Exploitation',
                'url': 'https://github.com/chenjj/CORScanner',
                'description': 'Scanner de vulnerabilidades CORS'
            }
        ],
        'tools': [
            {'name': 'CORScanner', 'url': 'https://github.com/chenjj/CORScanner', 'description': 'Herramienta automática de análisis CORS'},
            {'name': 'Burp Suite', 'url': 'https://portswigger.net/burp', 'description': 'Para analizar headers CORS'}
        ]
    }

def get_auth_bypass_resources():
    """Recursos para Authentication Bypass."""
    return {
        'github_pocs': [
            {
                'name': 'PayloadsAllTheThings - Authentication',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Authentication',
                'description': 'Técnicas de bypass de autenticación'
            },
            {
                'name': 'JWT Attack Playbook',
                'url': 'https://github.com/ticarpi/jwt_tool',
                'description': 'Herramienta para atacar JWT'
            }
        ],
        'tools': [
            {'name': 'Hydra', 'url': 'https://github.com/vanhauser-thc/thc-hydra', 'description': 'Para brute force de credenciales'},
            {'name': 'JWT_Tool', 'url': 'https://github.com/ticarpi/jwt_tool', 'description': 'Para manipulación de tokens JWT'}
        ]
    }

def get_headers_resources():
    """Recursos para Security Headers."""
    return {
        'github_pocs': [
            {
                'name': 'Security Headers Best Practices',
                'url': 'https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/HTTP_Headers_Cheat_Sheet.md',
                'description': 'Guía de headers de seguridad (OWASP)'
            },
            {
                'name': 'Clickjacking POCs',
                'url': 'https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Clickjacking',
                'description': 'Técnicas y POCs de clickjacking'
            }
        ],
        'tools': [
            {'name': 'SecurityHeaders.com', 'url': 'https://securityheaders.com', 'description': 'Análisis online de headers'},
            {'name': 'Mozilla Observatory', 'url': 'https://observatory.mozilla.org', 'description': 'Scanner de seguridad web'}
        ]
    }

# Mapeo de tipos de vulnerabilidad a funciones de recursos
RESOURCE_MAP = {
    'xss': get_xss_resources,
    'sqli': get_sqli_resources,
    'sql': get_sqli_resources,
    'csrf': get_csrf_resources,
    'lfi': get_lfi_resources,
    'ssrf': get_ssrf_resources,
    'xxe': get_xxe_resources,
    'cmdi': get_command_injection_resources,
    'command': get_command_injection_resources,
    'rce': get_command_injection_resources,
    'cors': get_cors_resources,
    'auth': get_auth_bypass_resources,
    'headers': get_headers_resources,
    'header': get_headers_resources
}

def get_resources_for_vuln_type(vuln_type):
    """
    Obtiene recursos (POCs de GitHub y herramientas) para un tipo de vulnerabilidad.
    
    Args:
        vuln_type: Tipo de vulnerabilidad (xss, sqli, csrf, etc.)
    
    Returns:
        Dict con github_pocs y tools, o None si no hay recursos específicos
    """
    vuln_type_lower = vuln_type.lower()
    
    for key, func in RESOURCE_MAP.items():
        if key in vuln_type_lower:
            return func()
    
    return None
